--WARNING! ERRORS ENCOUNTERED DURING SQL PARSING!
-- SQL 
-- Oracle ?? || ???? ???
-- SELECT ??? WHERE ??? 'INDEX?? = ??????~ ' ?? ?????? INDEX COLUMN TUNING ??? ??.

--???? ??? ??? ??? ????? ??. ???, ???, ??? ?? ??? ?? ???? ?? ???? ????
--???? VARCHAR2 ??? ????? ?? 10? ?????? ?? 10?? ????.
--?? ?????? WHERE?? ??? ? ??? COLUMN = 10 ??? ??? COLUMN ??? ?????? ???? ???????
--?? ???? TO_NUMBER(COLUMN)?? ???? ???? ??? ?? ???? ?? ?? ??? ???? ???.
--? ????? ?? ????.

SELECT count(1)		-- count(*) ? count(1) ? ??? ??. 
FROM (				-- ?, count(*) ? count(???)? ??? ??? NULL ?? count, ??? NULL ?? count ?? ??
	SELECT A.MGYEAR || A.MGMONTH AS CLS_YM
		,B.ACTG_SEP_CD
		,SUBSTR(A.KOSTL, 7, 4) AS orgz_CD
		,A.GSBER AS BZ_AREA_CD
		,NVL(SUBSTR(A.ZZRCTTR, 7, 4), ' ') AS SCHD 
		,CASE WHEN TRIM(B.IFRS4_ACT_CD) IS NOT NULL				-- ???? ?? ???? CASE?? DECODE? ???? ???
			THEN B.IFRS4_ACT_CD									-- ??/??? ??? CASE?? ?? ???.
			ELSE SUBSTR(A.ACTCD, 3, 8)
		 END
		,SUBSTR(TO_NUMBER(NVL(A.AMOUNT1, 0))) AS BZEX_AMT
		,'BEL01030'
		,SYS DATE AS DB_REG_DTTM
	FROM ACC_SAP_BUDGET A ,IFRBE010MC B
	WHERE A.MGYEAR || A.MGMONTH = #{clsYm}
		AND A.GSBER IN ('1000','3000')							-- A.GSBER ? '1000' or '3000' ? ??
		<![CDATA[ AND TO_NUMBER(NVL(A.AMOUNT1,0)) <> 0 ]]>
		AND B.CLS_YM = A.MGYEAR||A.MGMONTH
		AND B.ACTG_SEP_CD = #{actgSepCd}
		AND B.ACT_CD = SUBSTR(A.ACTCD,3,8)
		AND B.DLT_YN = 'N'
	GROUP BY A.MGYEAR||A.MONTH
		, B.ACTG_SEP_CD
		, CASE WHEN TRIM(B.IFRS4_ACT_CD) IS NOT NULL
			THEN B.IFRS4_ACT_CD
			ELSE SUBSTR(A.ACTCD, 3, 8)
		  END
	) A